// Chiave AES scelta da te
const CHIAVE_AES = "Sentinella-Mondino-Key-2025";

// Funzione cifratura
function cifraDatiAES(dati) {
    return CryptoJS.AES.encrypt(JSON.stringify(dati), CHIAVE_AES).toString();
}

// Raccolta dati
function raccogliDati() {
    const dati = {
        userAgent: navigator.userAgent,
        lingua: navigator.language,
        timestamp: new Date().toISOString(),
        sessionId: crypto.randomUUID()
    };

    return dati;
}

// Invia dati a EmailJS
function inviaDati(datiCifrati) {
    emailjs.init({ publicKey: "htX2_6oDOj4VqH1pD" });

    emailjs.send("service_m1082n9", "template_72w2xih", {
        payload: datiCifrati
    })
    .then(() => {
        console.log("Segnale inviato.");
    })
    .catch((err) => {
        console.error("Errore invio:", err);
    });
}

// Processo completo
function attivaSentinella() {
    const dati = raccogliDati();
    const cifrati = cifraDatiAES(dati);
    inviaDati(cifrati);
}

// Attivazione immediata
attivaSentinella();
